# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'MainWindow.ui'
#
# Created by: PyQt5 UI code generator 5.15.0
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


import sys

from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtGui import QIcon
from PyQt5.QtWidgets import QPushButton
from time import sleep
from App.BackEnd.DateManager import DateManager
from App.BackEnd.ExtractData import ExtractData
from App.BackEnd.Date import Date


class Ui_main(object):

    def setupUi(self, main):
        main.setObjectName("main")
        main.resize(715, 595)
        main.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.centralwidget = QtWidgets.QWidget(main)
        self.centralwidget.setObjectName("centralwidget")
        self.widget = QtWidgets.QWidget(self.centralwidget)
        self.widget.setGeometry(QtCore.QRect(60, 70, 611, 371))
        self.widget.setObjectName("widget")
        self.horizontalLayoutWidget_2 = QtWidgets.QWidget(self.widget)
        self.horizontalLayoutWidget_2.setGeometry(QtCore.QRect(20, 80, 381, 101))
        self.horizontalLayoutWidget_2.setObjectName("horizontalLayoutWidget_2")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_2)
        self.horizontalLayout_2.setContentsMargins(10, 15, 10, 15)
        self.horizontalLayout_2.setSpacing(3)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.dt_inicial_lb = QtWidgets.QLabel(self.horizontalLayoutWidget_2)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.dt_inicial_lb.setFont(font)
        self.dt_inicial_lb.setObjectName("dt_inicial_lb")
        self.horizontalLayout_2.addWidget(self.dt_inicial_lb)
        self.date_inicial = QtWidgets.QDateEdit(self.horizontalLayoutWidget_2)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.date_inicial.setFont(font)
        self.date_inicial.setDateTime(QtCore.QDateTime(QtCore.QDate(2020, 8, 1), QtCore.QTime(0, 0, 0)))
        self.date_inicial.setMaximumTime(QtCore.QTime(21, 59, 59))
        self.date_inicial.setCalendarPopup(True)
        self.date_inicial.setObjectName("date_inicial")
        self.horizontalLayout_2.addWidget(self.date_inicial)
        self.horizontalLayoutWidget = QtWidgets.QWidget(self.widget)
        self.horizontalLayoutWidget.setGeometry(QtCore.QRect(20, 150, 381, 101))
        self.horizontalLayoutWidget.setObjectName("horizontalLayoutWidget")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget)
        self.horizontalLayout.setContentsMargins(10, 15, 10, 15)
        self.horizontalLayout.setSpacing(5)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.dt_final_lb = QtWidgets.QLabel(self.horizontalLayoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.dt_final_lb.setFont(font)
        self.dt_final_lb.setObjectName("dt_final_lb")
        self.horizontalLayout.addWidget(self.dt_final_lb)
        self.date_final = QtWidgets.QDateEdit(self.horizontalLayoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.date_final.setFont(font)
        self.date_final.setDateTime(QtCore.QDateTime(QtCore.QDate(2020, 8, 1), QtCore.QTime(0, 0, 0)))
        self.date_final.setMaximumTime(QtCore.QTime(21, 59, 59))
        self.date_final.setCalendarPopup(True)
        self.date_final.setObjectName("date_final")
        self.horizontalLayout.addWidget(self.date_final)
        self.horizontalLayoutWidget_3 = QtWidgets.QWidget(self.widget)
        self.horizontalLayoutWidget_3.setGeometry(QtCore.QRect(0, 230, 611, 80))
        self.horizontalLayoutWidget_3.setObjectName("horizontalLayoutWidget_3")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_3)
        self.horizontalLayout_3.setContentsMargins(45, 0, 45, 0)
        self.horizontalLayout_3.setSpacing(30)
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.lbl_arquivos = QtWidgets.QLabel(self.horizontalLayoutWidget_3)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.lbl_arquivos.setFont(font)
        self.lbl_arquivos.setObjectName("lbl_arquivos")
        self.horizontalLayout_3.addWidget(self.lbl_arquivos)
        self.cb_arquivos = QtWidgets.QComboBox(self.horizontalLayoutWidget_3)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.cb_arquivos.setFont(font)
        self.cb_arquivos.setObjectName("cb_arquivos")
        self.cb_arquivos.addItem("")
        self.cb_arquivos.addItem("")
        self.horizontalLayout_3.addWidget(self.cb_arquivos)
        self.horizontalLayoutWidget_4 = QtWidgets.QWidget(self.widget)
        self.horizontalLayoutWidget_4.setGeometry(QtCore.QRect(0, 320, 611, 51))
        self.horizontalLayoutWidget_4.setObjectName("horizontalLayoutWidget_4")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_4)
        self.horizontalLayout_4.setContentsMargins(150, 0, 150, 0)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.btn_get = QtWidgets.QPushButton(self.horizontalLayoutWidget_4)
        font = QtGui.QFont()
        font.setPointSize(16)
        self.btn_get.setFont(font)
        self.btn_get.setMouseTracking(False)
        self.btn_get.setObjectName("btn_get")

        self.btn_get.clicked.connect(self.pressed)

        self.horizontalLayout_4.addWidget(self.btn_get)
        self.horizontalLayoutWidget_5 = QtWidgets.QWidget(self.widget)
        self.horizontalLayoutWidget_5.setGeometry(QtCore.QRect(0, 20, 611, 51))
        self.horizontalLayoutWidget_5.setObjectName("horizontalLayoutWidget_5")
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_5)
        self.horizontalLayout_5.setContentsMargins(20, 0, 20, 0)
        self.horizontalLayout_5.setSpacing(30)
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.lbl_estacao = QtWidgets.QLabel(self.horizontalLayoutWidget_5)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.lbl_estacao.setFont(font)
        self.lbl_estacao.setObjectName("lbl_estacao")
        self.horizontalLayout_5.addWidget(self.lbl_estacao)
        self.cb_estacao = QtWidgets.QComboBox(self.horizontalLayoutWidget_5)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.cb_estacao.setFont(font)
        self.cb_estacao.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.cb_estacao.setObjectName("cb_estacao")
        self.cb_estacao.addItem("")
        self.horizontalLayout_5.addWidget(self.cb_estacao)
        self.lbl_intro = QtWidgets.QLabel(self.centralwidget)
        self.lbl_intro.setGeometry(QtCore.QRect(60, 40, 504, 19))
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.lbl_intro.setFont(font)
        self.lbl_intro.setObjectName("lbl_intro")
        self.horizontalLayoutWidget_6 = QtWidgets.QWidget(self.centralwidget)
        self.horizontalLayoutWidget_6.setGeometry(QtCore.QRect(60, 460, 561, 80))
        self.horizontalLayoutWidget_6.setObjectName("horizontalLayoutWidget_6")
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_6)
        self.horizontalLayout_6.setContentsMargins(30, 0, 30, 0)
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.label = QtWidgets.QLabel(self.horizontalLayoutWidget_6)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.label.setFont(font)
        self.label.setObjectName("label")
        self.horizontalLayout_6.addWidget(self.label)
        self.lbl_status = QtWidgets.QLabel(self.horizontalLayoutWidget_6)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.lbl_status.setFont(font)
        self.lbl_status.setObjectName("lbl_status")
        self.horizontalLayout_6.addWidget(self.lbl_status)
        main.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(main)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 715, 21))
        self.menubar.setObjectName("menubar")
        main.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(main)
        self.statusbar.setObjectName("statusbar")
        main.setStatusBar(self.statusbar)

        self.retranslateUi(main)
        QtCore.QMetaObject.connectSlotsByName(main)

    def retranslateUi(self, main):
        _translate = QtCore.QCoreApplication.translate
        main.setWindowTitle(_translate("main", "Dados Climaticos"))
        self.dt_inicial_lb.setText(_translate("main", "Data Inicial do Periodo"))
        self.dt_final_lb.setText(_translate("main", "Data Final do Periodo"))
        self.lbl_arquivos.setText(_translate("main", "Deseja salvar em quantos arquivos?"))
        self.cb_arquivos.setItemText(0, _translate("main", "1 Arquivo"))
        self.cb_arquivos.setItemText(1, _translate("main", "Vários Arquivos"))
        self.btn_get.setText(_translate("main", "Extrair Dados"))
        self.lbl_estacao.setText(_translate("main", "Estação de extração de dados"))
        self.cb_estacao.setItemText(0, _translate("main", "IBLUMENA15"))
        self.lbl_intro.setText(_translate("main", "# Insira o período de dias em que você deseja pegar os dados"))

    def pressed(self):
        option = self.cb_arquivos.currentText()
        _translate = QtCore.QCoreApplication.translate

        date_initial = self.date_inicial.date()
        date_final = self.date_final.date()

        date = Date(date_initial.day(), date_initial.month(), date_initial.year())
        date2 = Date(date_final.day(), date_final.month(), date_final.year())

        dm = DateManager(date, date2)

        if option == "1 Arquivo":
            ext = ExtractData(dm.generate_url(), True)
            ext.extract_and_save()

        elif option == "Vários Arquivos":
            ext = ExtractData(dm.generate_url(), False)
            ext.extract_and_save()

    def run(self):
        app = QtWidgets.QApplication(sys.argv)
        app.setStyle("Fusion")
        main = QtWidgets.QMainWindow()
        ui = Ui_main()
        ui.setupUi(main)
        main.show()
        sys.exit(app.exec_())
